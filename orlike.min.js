function setCookie(a,b,c){var d=new Date();d.setTime(d.getTime()+(c*24*60*60*1000));var e="expires="+d.toGMTString();document.cookie=a+"="+b+"; "+e}function getCookie(a){var b=a+"=";var d=document.cookie.split(';');for(var i=0;i<d.length;i++){var c=d[i].trim();if(c.indexOf(b)==0){return c.substring(b.length,c.length)}}return""}function OrLike(a,b,c){this.serverUrl=serverUrl;this.el=el;this.days=days;this.ckid="";this.init()}OrLike.prototype.init=function(){server_url=this.serverUrl;obj=this;$.ajax({type:'GET',url:server_url+'/tmp',dataType:'jsonp',jsonp:"callback",jsonpCallback:"success",xhrFields:{withCredentials:true},async:true,crossDomain:true,success:function(a){$(obj.el).html(a.template);obj.ckusr(obj);$('.likeit').click({obj:obj},obj.like);$('.dislikeit').click({obj:obj},obj.dislike)},})}OrLike.prototype.ckusr=function(b){server_url=this.serverUrl;$.ajax({type:'GET',url:server_url+'/ckusr',dataType:'jsonp',jsonp:"callback",jsonpCallback:"success",xhrFields:{withCredentials:true},async:false,crossDomain:true,success:function(a){if(a.stat=='ok'){b.ckid=a.ckid;if(!getCookie(a.ckid)){setCookie(a.ckid,a.uid,b.days)}b.query()}else{console.error('connect orlike failed!!!')}},})}OrLike.prototype.query=function(){server_url=this.serverUrl;$.ajax({type:'GET',url:server_url+'/qry?link='+window.location.pathname,dataType:'jsonp',jsonp:"callback",jsonpCallback:"success",xhrFields:{withCredentials:true},crossDomain:true,success:function(a){if(a.stat=='ok'){$('.likeit i span').text(a['like']);$('.dislikeit i span').text(a['dislike'])}else{console.error('query orlike failed!!!')}},})}OrLike.prototype.orl=function(b,c){server_url=b.serverUrl;req_url=server_url+'/orl?method='+c+'&link='+window.location.pathname+'&'+b.ckid+'='+getCookie(b.ckid);$.ajax({type:'GET',url:req_url,dataType:'jsonp',jsonp:"callback",jsonpCallback:"success",xhrFields:{withCredentials:true},crossDomain:true,success:function(a){b.query()},})}OrLike.prototype.like=function(a){obj=a.data.obj;obj.orl(obj,'like')}OrLike.prototype.dislike=function(a){obj=a.data.obj;obj.orl(obj,'dislike')}